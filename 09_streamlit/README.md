# Прогноз оттока клиентов

Этот проект представляет собой веб-приложение для прогнозирования оттока клиентов с использованием моделей `RandomForest` и `LightGBM`. Приложение создано с использованием библиотеки `Streamlit` и предоставляет возможность пользователю ввести параметры клиента, чтобы получить предсказание вероятности оттока.

## Структура проекта
```
09_streamlit/
│
├── models/                 
│   ├── RF_model.pkl         # Модель RandomForest для выбора признаков
│   └── LGB_model.pkl        # Модель LightGBM для предсказания
│
├── data/
│   ├── train.csv            # Данные, использованные для обучения моделей
│   └── customer_churn.jpeg  # Изображение, использованное в приложении
│
├── notebooks/
│   └── create_model.ipynb   # Jupyter notebook с процессом создания модели
│
├── configs/
│   ├── feature_constraints.yaml  # Конфигурационные ограничения для признаков
│   └── metrics.yaml              # Целевая метрика модели на тестовой выборке
│
├── app.py                     # Основной файл приложения Streamlit
├── requirements.txt           # Файл с зависимостями
└── README.md                  # Текущее описание проекта
```
## Используемые технологии
- **Streamlit**: для создания веб-приложения.
- **LightGBM**: для предсказания оттока клиентов.
- **RandomForest**: для выбора наиболее важных признаков.
- **Pandas, Numpy**: для работы с данными.

## Установка
1. Клонируйте репозиторий на ваш компютер:

```bash
git clone https://github.com/young-epish/ds_start.git
```
2. Установите зависимости:

Рекомендуется создать и активировать виртуальное окружение:

```bash
python -m venv venv # Создание виртуального окружения
source venv/bin/activate  # для Linux/Mac
venv\Scripts\activate     # для Windows
```
Установите зависимости, указанные в `requirements.txt`:

```bash
pip install -r requirements.txt
```
3. Запустите приложение:

Выполните команду из директории *09_streamlit*:

```bash
streamlit run app.py
```
Откройте приложение в браузере по адресу http://localhost:8501.

## Использование
1. Ввод данных:
* Выберите возраст, баланс на счете, используемые банковские продукты, статус активности, страну проживания и пол клиента.
2. Предсказание:
* После ввода данных нажмите кнопку "Предсказать вероятность оттока". Прогресс-бар отобразит ход выполнения расчета, и в конце вы увидите вероятность оттока клиента.

## Примечания
* Данные для обучения: Данные были использованы из [соревнования Kaggle](https://www.kaggle.com/competitions/playground-series-s4e1).
* Модели: `RandomForest` используется для выбора наиболее важных признаков, а `LightGBM` — для конечного предсказания.
* Целевая метрика: Метрика, по которой оценивалась модель, доступна в конфигурационном файле `metrics.yaml`.

## Автор
Епишков Владислав (vlad-epishkov@rambler.ru)